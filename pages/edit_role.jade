extends ./layout

block link
    -var selected = 'Security';
block content
    script(src="../../scripts/edit_role.js")
    // Breadcrumb
    .breadcrumb-holder
        .container-fluid
            ul.breadcrumb
                li.breadcrumb-item
                    a(href='/security') Security Home
                li.breadcrumb-item.active Edit Role
    // Counts Section
    .pagebox
        - var usedSchemas = JSON.stringify(schemas)
        - var usedRoles = JSON.stringify(roles)
        input#usedSchemas(type="hidden", name="usedSchemas" value="#{usedSchemas}")
        input#usedRoles(type="hidden", name="usedRoles" value="#{usedRoles}")
        section.dashboard-counts
            header
                .boxdisplay
                    | Search Roles  
                    input#searchRole.ml-3(type='text')
                    a.btn.btn-main.dropdown-toggle.minwidthcombobox.pull-right(href='/security/add_role') Add New
        each role in roles            
            section(id="#{role.role}")
                hr
                .clear
                    .boxdisplay
                        .pull-left
                            .boxdisplay-6
                                span.mr-3.largetext
                                    a(href='#' class="editName changingName_#{role.role}")
                                        i.fa.fa-pencil
                                    span(class="showName changingName_#{role.role}")
                                        | #{role.role}
                                input#newRoleName(type='text' value="#{role.role}" hidden)
                                span.ml-5.mr-3 Super Admin
                                input#superadmin.js-switch(type='checkbox')
                        button.btn.btn-mainadd.pull-right.width100(type='button', data-toggle='dropdown', aria-haspopup='true', aria-expanded='false')
                            | Save
                .clear.pt-3
                    .boxdisplay
                        .pull-left
                            .boxdisplay-6
                                span.mr-5 Schema
                                span.ml-5.mr-3 Activate All
                                input.js-switch.all-schema#all-schema(type='checkbox', checked='checked')
                    .boxdisplay.form-group.clear
                        each schemaVal, schemaProp in schemas
                            ul.trees
                                li
                                    label.tree_label
                                        i.fa.fa-caret-down
                                        | #{schemaProp}
                                    ul
                                        li
                                        label.tree_label
                                        | Tables
                                        span.ml-5.mr-3 Activate All
                                        input.js-switch.schema(type='checkbox', id="#{schemaProp}", class="#{schemaProp}", checked='checked')
                                        if schemas[schemaProp] != undefined

                                            each tableVal, tableProp in schemas[schemaProp]
                                                li
                                                    label.tree_label(style="width: 130px")
                                                        i.fa.fa-caret-down
                                                        | #{tableProp}
                                                    span.ml-5.mr-3(style="text-align: right")    Activate All
                                                    input.js-switch.table(type='checkbox', id="#{schemaProp}_#{tableProp}", class="#{schemaProp} #{schemaProp}_#{tableProp}", checked='checked')

                                                    ul
                                                        li
                                                            label.tree_label(title='Read')
                                                                | R
                                                                input.js-switch(type='checkbox', id="#{schemaProp}_#{tableProp}_R", class="#{schemaProp} #{schemaProp}_#{tableProp}", checked='checked')
                                                        li                                            
                                                            label.tree_label(title='Insert')
                                                                | I
                                                                input.js-switch(type='checkbox', id="#{schemaProp}_#{tableProp}_I", class="#{schemaProp} #{schemaProp}_#{tableProp}", checked='checked')
                                                        li                                            
                                                            label.tree_label(title='Update')
                                                                | U
                                                                input.js-switch(type='checkbox', id="#{schemaProp}_#{tableProp}_U", class="#{schemaProp} #{schemaProp}_#{tableProp}", checked='checked')
                                                        li                                            
                                                            label.tree_label(title='Delete')
                                                                | D
                                                                input.js-switch(type='checkbox', id="#{schemaProp}_#{tableProp}_D", class="#{schemaProp} #{schemaProp}_#{tableProp}", checked='checked')
                                                        li
                                                            input(type='checkbox', checked='checked')
                                                            label.tree_label
                                                                i.fa.fa-caret-down
                                                                |  Attribute Restrictions
                                                            span.ml-5.mr-3 Activate All
                                                            input.js-switch.attribute(type='checkbox', id="#{schemaProp}_#{tableProp}_All", class="#{schemaProp} #{schemaProp}_#{tableProp}", checked='checked')

                                                            ul
                                                                if schemas[schemaProp][tableProp] != undefined
                                                                    if schemas[schemaProp][tableProp]["attributes"] != undefined
                                                                        each attributesValue, attributesProp in schemas[schemaProp][tableProp]['attributes']
                                                                            li
                                                                                span(style="width: 80px;") #{attributesValue['attribute']}
                                                                                span(style="width: 300px; text-align: right")
                                                                                    span.ml-3.mr-0(title='Read') R
                                                                                    input.js-switch(class="#{schemaProp} #{schemaProp}_#{tableProp} #{schemaProp}_#{tableProp}_All", type='checkbox', id="#{schemaProp}_#{tableProp}_#{attributesValue['attribute']}_R", checked='checked')
                                                                                    span.ml-3.mr-0(title='Insert') I
                                                                                    input.js-switch(class="#{schemaProp} #{schemaProp}_#{tableProp} #{schemaProp}_#{tableProp}_All", type='checkbox', id="#{schemaProp}_#{tableProp}_#{attributesValue['attribute']}_I", checked='checked')
                                                                                    span.ml-3.mr-0(title='Update') U
                                                                                    input.js-switch(class="#{schemaProp} #{schemaProp}_#{tableProp} #{schemaProp}_#{tableProp}_All", type='checkbox', id="#{schemaProp}_#{tableProp}_#{attributesValue['attribute']}_U", checked='checked')
                                                                                    span.ml-3.mr-0(title='Delete') D
                                                                                    input.js-switch(class="#{schemaProp} #{schemaProp}_#{tableProp} #{schemaProp}_#{tableProp}_All", type='checkbox', id="#{schemaProp}_#{tableProp}_#{attributesValue['attribute']}_D", checked='checked')        
                        header
                            .boxdisplay.largetitle
                                .pull-right
                                    i.fa.fa-trash(data-toggle='modal', data-target='#deleteUserModal', style='margin-right:10px;')
                br

